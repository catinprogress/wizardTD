<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GameplayActions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">scaffold</a> &gt; <a href="index.source.html" class="el_package">WizardTD</a> &gt; <span class="el_source">GameplayActions.java</span></div><h1>GameplayActions.java</h1><pre class="source lang-java linenums">package WizardTD;

import processing.core.PApplet;

public abstract class GameplayActions extends Shape {
<span class="fc" id="L6">    public static final int[] BACKGROUND = {130, 116, 79};</span>
<span class="fc" id="L7">    public static final int[] CLICKED = {147,193,235};</span>
<span class="fc" id="L8">    public static final int[] HOVER = {206, 206, 206};</span>
    
    public static final int FONTSIZE = 25;
    public static final int SUBFONTSIZE = 11;
    
    public static final int X = 648;
    public static final int DIMENSION = 40;
    
<span class="fc" id="L16">    public final float MAIN_X = x + DIMENSION/2;</span>
<span class="fc" id="L17">    public final float MAIN_Y = y + DIMENSION/2 - 3;</span>
<span class="fc" id="L18">    public final float SUB_X = x + DIMENSION + 8;</span>
<span class="fc" id="L19">    public final float SUB_Y = y + 15;</span>
    
    public static final int COSTSIZE = 10;
<span class="fc" id="L22">    public static final int[] COSTBOX = {233,226,255};</span>
    public static final int COST_X = X - 37;
<span class="fc" id="L24">    public final float COST_Y = y + 11;</span>

    protected boolean selected; //remember last click
    protected boolean mouseClicked;
    protected static boolean key_was_pressed;
    
    //protected static char last_key;
    protected char key_flag;
    
    protected String main_text;
    protected String sub_text;
    protected UpgradeCost cost;


    public GameplayActions(float y, char key_flag, String main_text, String sub_text) {
<span class="fc" id="L39">        super(X, y, DIMENSION, DIMENSION, HOVER, BACKGROUND);</span>
<span class="fc" id="L40">        selected = false;</span>
<span class="fc" id="L41">        mouseClicked = false;</span>
<span class="fc" id="L42">        key_was_pressed = false;</span>
<span class="fc" id="L43">        this.key_flag = key_flag;</span>
<span class="fc" id="L44">        this.main_text = main_text;</span>
<span class="fc" id="L45">        this.sub_text = sub_text;</span>
<span class="fc" id="L46">    }</span>

    /**
     * Called by subclass that extends PApplet class when a mouse click event occurs
     */
    public void setMouseClicked() {
<span class="fc" id="L52">        mouseClicked = true;</span>
<span class="fc" id="L53">    }</span>

    /**
     * Retrieves the status of a mouse click event
     * @return mouseClicked; true if mouse was clicked, false otherwise
     */
    public boolean getMouseClicked() {
<span class="fc" id="L60">        return mouseClicked;</span>
    }

    /**
     * Retrieves the status of a key press event
     * @return key_was_pressed; true if a key was pressed, false otherwise
     */
    public static boolean keyWasPressed() {
<span class="fc" id="L68">        return key_was_pressed;</span>
    }

    /**
     * Called by a subclass of PApplet to change status of key press event
     * @param flag boolean value indicating whether key was pressed or not
     */
    public static void setKeyWasPressed(boolean flag) {
<span class="fc" id="L76">        key_was_pressed = flag;</span>
<span class="fc" id="L77">    }</span>

    /**
     * Indicates whether the current subclass instance has been selected or not
     * @return selected
     */
    public boolean isSelected() {
<span class="fc" id="L84">        return selected;</span>
    }

    /**
     * Retrieves the key as char type that is associated with a GameplayAction subclass
     * @return key_flag
     */
    public char getKey() {
<span class="fc" id="L92">        return key_flag;</span>
    }

    /**
     * Checks if the current mouse position is at the current instance's button
     * @param app that instantiates the subclass
     * @return true if mouse position is at the button, false otherwise
     */
    protected boolean mouse(PApplet app) {
<span class="pc bpc" id="L101" title="3 of 8 branches missed.">        if ((app.mouseX &gt;= x &amp;&amp; app.mouseX &lt;= x+DIMENSION) &amp;&amp; (app.mouseY &gt;= y &amp;&amp; app.mouseY &lt;= y+DIMENSION)) {</span>
<span class="fc" id="L102">            return true;</span>
        }
        else {
<span class="fc" id="L105">            return false;</span>
        }
    }

    /**
     * Logic for rendering the colour of the buttons on the screen, depending on the button's previous state and the current mouse/key event
     * Condition to change the colour of the button depends on whether the game has ended or not
     * @param app that instantiates the subclass
     * @param mana Mana object that indicates whether the player has lost the game
     * @param wave Wave object that indicates whether the player has won the game
     */
    //logic for rendering the colour of the buttons on the screen, depending on the button's previous state and mouse/key actions
    protected void setButtons(PApplet app, Mana mana, Wave wave) {
<span class="pc bpc" id="L118" title="1 of 4 branches missed.">        if (!mana.hasLost() &amp;&amp; !wave.hasWon()) {</span>
<span class="fc" id="L119">            app.strokeWeight(2);</span>
<span class="fc bfc" id="L120" title="All 4 branches covered.">            if (key_was_pressed &amp;&amp; (app.key == key_flag)) {</span>
<span class="fc" id="L121">                external_width = total_width;</span>
<span class="fc bfc" id="L122" title="All 2 branches covered.">                if (!selected) {</span>
<span class="fc" id="L123">                    external_colour = CLICKED;</span>
<span class="fc" id="L124">                    selected = true;</span>
                }
<span class="pc bpc" id="L126" title="1 of 2 branches missed.">                else if (selected) {</span>
<span class="fc" id="L127">                    selected = false;</span>
<span class="fc" id="L128">                    external_width = 0;</span>
                    
                } 
<span class="fc" id="L131">                key_was_pressed = false; </span>
            }
<span class="fc bfc" id="L133" title="All 2 branches covered.">            else if (mouse(app)) {</span>
<span class="fc" id="L134">                external_width = total_width;</span>
<span class="pc bpc" id="L135" title="1 of 4 branches missed.">                if (mouseClicked &amp;&amp; !selected) {</span>
<span class="fc" id="L136">                    external_colour = CLICKED;</span>
<span class="fc" id="L137">                    selected = true;</span>
                }
<span class="pc bpc" id="L139" title="2 of 4 branches missed.">                else if (mouseClicked &amp;&amp; selected) {</span>
<span class="fc" id="L140">                    selected = false;</span>
<span class="fc" id="L141">                    external_colour = HOVER;</span>
                }
<span class="nc bnc" id="L143" title="All 4 branches missed.">                else if (!selected &amp;&amp; (app.key != key_flag)) {</span>
<span class="nc" id="L144">                    external_colour = HOVER;</span>
                }
<span class="nc bnc" id="L146" title="All 4 branches missed.">                else if (selected &amp;&amp; (app.key != key_flag)) {</span>
<span class="nc" id="L147">                    external_colour = CLICKED;</span>
                }    
            }
<span class="fc bfc" id="L150" title="All 2 branches covered.">            else if (!selected) {</span>
<span class="fc" id="L151">                setExternalWidth(0);</span>
            }            
<span class="fc" id="L153">            mouseClicked = false;</span>
        }   
<span class="fc" id="L155">    }</span>

    /**
     * Renders the button and its labels on the screen
     * @param app that instantiates the subclass
     * @param mana Mana object to be used by setButtons method
     * @param wave Wave object to be used by setButtons method
     */
    public void drawButtons(PApplet app, Mana mana, Wave wave) {
<span class="fc" id="L164">        setButtons(app, mana, wave);</span>
<span class="fc" id="L165">        drawRectangle(app);</span>
<span class="fc" id="L166">        mainText(app);</span>
<span class="fc" id="L167">        subText(app);</span>
<span class="fc" id="L168">    }</span>
    
    /**
     * Used to change the current state of the button. If was not previously selected, selected becomes true, and false otherwise
     */
    public void setSelected() {
<span class="fc bfc" id="L174" title="All 2 branches covered.">        if (!selected) {</span>
<span class="fc" id="L175">            selected = true;</span>
        }
        else {
<span class="fc" id="L178">            selected = false;</span>
        }
<span class="fc" id="L180">    }</span>

    /**
     * Renders the main text that goes inside the button
     * @param app that instantiates the subclass
     */
    protected void mainText(PApplet app) {
<span class="fc" id="L187">        app.fill(0, 0, 0);</span>
<span class="fc" id="L188">        app.textSize(FONTSIZE);</span>
<span class="fc" id="L189">        app.textAlign(PApplet.CENTER, PApplet.CENTER);</span>
<span class="fc" id="L190">        app.text(main_text, MAIN_X, MAIN_Y);</span>
<span class="fc" id="L191">    }</span>

    /**
     * Renders the side text description that goes beside the button
     * @param app that instantiates the subclass
     */
    protected void subText(PApplet app) {
<span class="fc" id="L198">        app.fill(0, 0, 0);</span>
<span class="fc" id="L199">        app.textSize(SUBFONTSIZE);</span>
<span class="fc" id="L200">        app.textAlign(PApplet.LEFT);</span>
<span class="fc" id="L201">        app.text(sub_text, SUB_X, SUB_Y);</span>
<span class="fc" id="L202">    }</span>
    
    /**
     * Logic for rendering the box that displays the cost of some gameplay actions on the screen
     * Cost is displayed when mouse hovers over the button
     * @param app that instantiates the subclass
     * @param show_cost Shape object that draws the cost box
     * @param amount the amount to display
     */
    protected void showCost(PApplet app, Shape show_cost, int amount) {
<span class="pc bpc" id="L212" title="3 of 4 branches missed.">        if (mouse(app) &amp;&amp; !mouseClicked) {</span>
<span class="nc" id="L213">            app.strokeWeight(1);</span>
<span class="nc" id="L214">            show_cost.drawRectangle(app);</span>
            
<span class="nc" id="L216">            app.fill(0, 0, 0);</span>
<span class="nc" id="L217">            app.textSize(COSTSIZE);</span>
<span class="nc" id="L218">            app.textAlign(PApplet.CENTER, PApplet.CENTER);</span>
<span class="nc" id="L219">            app.text(&quot;Cost: &quot; + amount, COST_X, COST_Y);</span>
        }
<span class="fc" id="L221">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>