<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GameplayActions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">scaffold</a> &gt; <a href="index.source.html" class="el_package">WizardTD</a> &gt; <span class="el_source">GameplayActions.java</span></div><h1>GameplayActions.java</h1><pre class="source lang-java linenums">package WizardTD;

import processing.core.PApplet;

public abstract class GameplayActions extends Shape {
<span class="fc" id="L6">    public static final int[] BACKGROUND = {130, 116, 79};</span>
<span class="fc" id="L7">    public static final int[] CLICKED = {255, 255, 85};</span>
<span class="fc" id="L8">    public static final int[] HOVER = {206, 206, 206};</span>
    
    public static final int FONTSIZE = 25;
    public static final int SUBFONTSIZE = 11;
    
    public static final float X = 648;
    public static final float DIMENSION = 40;
    
<span class="fc" id="L16">    public final float MAIN_X = x + DIMENSION/2;</span>
<span class="fc" id="L17">    public final float MAIN_Y = y + DIMENSION/2 - 3;</span>
<span class="fc" id="L18">    public final float SUB_X = x + DIMENSION + 8;</span>
<span class="fc" id="L19">    public final float SUB_Y = y + 15;</span>
    
    public static final int COSTSIZE = 10;
<span class="fc" id="L22">    public static final int[] COSTBOX = {233,226,255};</span>
    public static final float COST_X = X - 37;
<span class="fc" id="L24">    public final float COST_Y = y + 11;</span>

    protected boolean selected; //remember last click
    protected boolean mouseClicked;
    protected static boolean key_was_pressed;
    
    protected static char last_key;
    protected char key_flag;
    
    protected String main_text;
    protected String sub_text;
    protected UpgradeCost cost;


    public GameplayActions(float y, char key_flag, String main_text, String sub_text) {
<span class="fc" id="L39">        super(X, y, DIMENSION, DIMENSION, HOVER, BACKGROUND);</span>
<span class="fc" id="L40">        selected = false;</span>
<span class="fc" id="L41">        mouseClicked = false;</span>
<span class="fc" id="L42">        key_was_pressed = false;</span>
<span class="fc" id="L43">        this.key_flag = key_flag;</span>
<span class="fc" id="L44">        this.main_text = main_text;</span>
<span class="fc" id="L45">        this.sub_text = sub_text;</span>
<span class="fc" id="L46">        last_key = '/';</span>

<span class="fc" id="L48">    }</span>

    /**
     * Called by subclass that extends PApplet class when a mouse click event occurs
     */
    public void setMouseClicked() {
<span class="fc" id="L54">        mouseClicked = true;</span>
<span class="fc" id="L55">    }</span>

    /**
     * Retrieves the status of a mouse click event
     * @return mouseClicked; true if mouse was clicked, false otherwise
     */
    public boolean getMouseClicked() {
<span class="fc" id="L62">        return mouseClicked;</span>
    }

    /**
     * Retrieves the status of a key press event
     * @return key_was_pressed; true if a key was pressed, false otherwise
     */
    public static boolean keyWasPressed() {
<span class="fc" id="L70">        return key_was_pressed;</span>
    }

    /**
     * Called by a subclass of PApplet to change status of key press event
     * @param flag boolean value indicating whether key was pressed or not
     */
    public static void setKeyWasPressed(boolean flag) {
<span class="fc" id="L78">        key_was_pressed = flag;</span>
<span class="fc" id="L79">    }</span>

    /**
     * Indicates whether the current subclass instance has been selected or not
     * @return selected
     */
    public boolean isSelected() {
<span class="fc" id="L86">        return selected;</span>
    }

    /**
     * Retrieves the key as char type that is associated with a GameplayAction subclass
     * @return key_flag
     */
    public char getKey() {
<span class="fc" id="L94">        return key_flag;</span>
    }

    /**
     * For testing purposes to simulate a key press event
     * @param key the key that was pressed
     */
    public void setLastKey(char key) {
<span class="fc" id="L102">        last_key = key;</span>
<span class="fc" id="L103">    }</span>


    /**
     * Checks if the current mouse position is at the current instance's button
     * @param app that instantiates the subclass
     * @return true if mouse position is at the button, false otherwise
     */
    protected boolean mouse(PApplet app) {
<span class="pc bpc" id="L112" title="7 of 8 branches missed.">        if ((app.mouseX &gt;= x &amp;&amp; app.mouseX &lt;= x+40) &amp;&amp; (app.mouseY &gt;= y &amp;&amp; app.mouseY &lt;= y+40)) {</span>
<span class="nc" id="L113">            return true;</span>
        }
        else {
<span class="fc" id="L116">            return false;</span>
        }
    }

    /**
     * Checks that the last key that was pressed by the user is the key flag for the current instance and sets the last_key variable to this flag if true
     * Ensures that key press events and mouse click events do not overlap
     * @param app that instantiates the subclass
     * @return true if last key press was key flag, false otherwise
     */
    public boolean checkKeyPressed(PApplet app) {
<span class="nc bnc" id="L127" title="All 2 branches missed.">        if (app.key == key_flag) {</span>
<span class="nc" id="L128">            last_key = key_flag;</span>
<span class="nc" id="L129">            return true;</span>
        }
<span class="nc" id="L131">        return false;</span>
    }

    /**
     * Logic for rendering the colour of the buttons on the screen, depending on the button's previous state and the current mouse/key event
     * Condition to change the colour of the button depends on whether the game has ended or not
     * @param app that instantiates the subclass
     * @param mana Mana object that indicates whether the player has lost the game
     * @param wave Wave object that indicates whether the player has won the game
     */
    //logic for rendering the colour of the buttons on the screen, depending on the button's previous state and mouse/key actions
    protected void setButtons(PApplet app, Mana mana, Wave wave) {
<span class="pc bpc" id="L143" title="1 of 4 branches missed.">        if (!mana.hasLost() &amp;&amp; !wave.hasWon()) {</span>
<span class="fc" id="L144">            app.strokeWeight(2);</span>

<span class="pc bpc" id="L146" title="3 of 4 branches missed.">            if (key_was_pressed &amp;&amp; (app.key == key_flag)) {</span>
<span class="nc" id="L147">                external_width = total_width;</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">                if (!selected) {</span>
<span class="nc" id="L149">                    external_colour = CLICKED;</span>
<span class="nc" id="L150">                    selected = true;</span>
                }
<span class="nc bnc" id="L152" title="All 2 branches missed.">                else if (selected) {</span>
<span class="nc" id="L153">                    selected = false;</span>
<span class="nc" id="L154">                    setExternalWidth(0);</span>
                }
<span class="nc" id="L156">                key_was_pressed = false;</span>
            }

<span class="pc bpc" id="L159" title="1 of 2 branches missed.">            if (mouse(app)) {</span>
<span class="nc" id="L160">                external_width = total_width;</span>
<span class="nc bnc" id="L161" title="All 4 branches missed.">                if (mouseClicked &amp;&amp; !selected) {</span>
<span class="nc" id="L162">                    external_colour = CLICKED;</span>
<span class="nc" id="L163">                    selected = true;</span>
                }
<span class="nc bnc" id="L165" title="All 4 branches missed.">                else if (mouseClicked &amp;&amp; selected) {</span>
<span class="nc" id="L166">                    selected = false;</span>
<span class="nc" id="L167">                    external_colour = HOVER;</span>
                }
<span class="nc bnc" id="L169" title="All 4 branches missed.">                else if (!selected &amp;&amp; (last_key != key_flag)) {</span>
<span class="nc" id="L170">                    external_colour = HOVER;</span>
                }
<span class="nc bnc" id="L172" title="All 4 branches missed.">                else if (selected &amp;&amp; (last_key != key_flag)) {</span>
<span class="nc" id="L173">                    external_colour = CLICKED;</span>
                }    
            }
<span class="pc bpc" id="L176" title="1 of 4 branches missed.">            else if (!selected &amp;&amp; (last_key != key_flag)) {</span>
<span class="fc" id="L177">                setExternalWidth(0);</span>
            }
<span class="pc bpc" id="L179" title="2 of 4 branches missed.">            else if (selected &amp;&amp; (last_key == key_flag)) {</span>
<span class="nc" id="L180">                external_width = total_width;</span>
<span class="nc" id="L181">                external_colour = CLICKED;</span>
            }
            
<span class="fc" id="L184">            mouseClicked = false;</span>
        }   
<span class="fc" id="L186">    }</span>

    /**
     * Renders the button and its labels on the screen
     * @param app that instantiates the subclass
     * @param mana Mana object to be used by setButtons method
     * @param wave Wave object to be used by setButtons method
     */
    public void drawButtons(PApplet app, Mana mana, Wave wave) {
<span class="fc" id="L195">        setButtons(app, mana, wave);</span>
<span class="fc" id="L196">        drawRectangle(app);</span>
<span class="fc" id="L197">        mainText(app);</span>
<span class="fc" id="L198">        subText(app);</span>
<span class="fc" id="L199">    }</span>
    
    /**
     * Used to change the current state of the button. If was not previously selected, selected becomes true, and false otherwise
     */
    public void setSelected() {
<span class="fc bfc" id="L205" title="All 2 branches covered.">        if (!selected) {</span>
<span class="fc" id="L206">            selected = true;</span>
        }
        else {
<span class="fc" id="L209">            selected = false;</span>
        }
<span class="fc" id="L211">    }</span>

    /**
     * Renders the main text that goes inside the button
     * @param app that instantiates the subclass
     */
    protected void mainText(PApplet app) {
<span class="fc" id="L218">        app.fill(0, 0, 0);</span>
<span class="fc" id="L219">        app.textSize(FONTSIZE);</span>
<span class="fc" id="L220">        app.textAlign(PApplet.CENTER, PApplet.CENTER);</span>
<span class="fc" id="L221">        app.text(main_text, MAIN_X, MAIN_Y);</span>
<span class="fc" id="L222">    }</span>

    /**
     * Renders the side text description that goes beside the button
     * @param app that instantiates the subclass
     */
    protected void subText(PApplet app) {
<span class="fc" id="L229">        app.fill(0, 0, 0);</span>
<span class="fc" id="L230">        app.textSize(SUBFONTSIZE);</span>
<span class="fc" id="L231">        app.textAlign(PApplet.LEFT);</span>
<span class="fc" id="L232">        app.text(sub_text, SUB_X, SUB_Y);</span>
<span class="fc" id="L233">    }</span>
    
    /**
     * Logic for rendering the box that displays the cost of some gameplay actions on the screen
     * Cost is displayed when mouse hovers over the button
     * @param app that instantiates the subclass
     * @param show_cost Shape object that draws the cost box
     * @param amount the amount to display
     */
    protected void showCost(PApplet app, Shape show_cost, int amount) {
<span class="pc bpc" id="L243" title="3 of 4 branches missed.">        if (mouse(app) &amp;&amp; !mouseClicked) {</span>
<span class="nc" id="L244">            app.strokeWeight(1);</span>
<span class="nc" id="L245">            show_cost.drawRectangle(app);</span>
            
<span class="nc" id="L247">            app.fill(0, 0, 0);</span>
<span class="nc" id="L248">            app.textSize(COSTSIZE);</span>
<span class="nc" id="L249">            app.textAlign(PApplet.CENTER, PApplet.CENTER);</span>
<span class="nc" id="L250">            app.text(&quot;Cost: &quot; + amount, COST_X, COST_Y);</span>
        }
<span class="fc" id="L252">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>